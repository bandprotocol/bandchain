const { expectRevert } = require("openzeppelin-test-helpers");
const CacheBridge = artifacts.require("CacheBridge");
const BridgeCacheConsumerMock = artifacts.require("BridgeCacheConsumerMock");

require("chai").should();

contract("CacheBridge", ([_, owner, alice, bob]) => {
  context(
    "Checking oracle state relaying and consumtion  (4 validators)",
    () => {
      beforeEach(async () => {
        this.template = [
          "from_scan",
          "1",
          "0x000000034254430000000000000064",
          "4",
          "4",
        ];
        this.cache = await CacheBridge.new(
          [
            ["0x652D89a66Eb4eA55366c45b1f9ACfc8e2179E1c5", 100],
            ["0x88e1cd00710495EEB93D4f522d16bC8B87Cb00FE", 100],
            ["0xaAA22E077492CbaD414098EBD98AA8dc1C7AE8D9", 100],
            ["0xB956589b6fC5523eeD0d9eEcfF06262Ce84ff260", 100],
          ],
          { from: owner },
        );

        this.consumer = await BridgeCacheConsumerMock.new(
          this.cache.address,
          this.template,
          { from: alice },
        );
      });

      it("should get correct configs from the consumer", async () => {
        (await this.consumer.bridgeCache())
          .toString()
          .should.eq(this.cache.address.toString());

        const {
          clientId,
          oracleScriptId,
          params,
          askCount,
          minCount,
        } = await this.consumer.requestTemplate();

        [
          clientId,
          oracleScriptId.toString(),
          params,
          askCount.toString(),
          minCount.toString(),
        ]
          .toString()
          .should.eq(this.template.toString());
      });

      it("should be able relay and get response from state", async () => {
        await expectRevert(
          this.cache.getLatestResponse(this.template),
          "RESPONSE_NOT_FOUND",
        );

        await this.cache.relay(
          "0x0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000005e00000000000000000000000000000000000000000000000000000000000000a0e5b14e631db5cdbb2c068be853242e45a091e9c178a5ca180656a12f6afde184472628869fbd308d01fcbd3411df82b10329b57df6c0c44626024e1bb0465b9486fdb04f6871c5d4bd5cb74a4c5a13a537bdd1159f7c38e797d297bc5f19770fbb1f2fd852e790e735ca2d3014f96a2a53c60393e9c6bbf941b9a6dd6a05cf6f97e9cc402179a6714d7a4e34d8ddd21e853780a131455be3cdf89760b972c4b2532fa694879095840619f5e49380612bd296ff7e950eafb66ff654d99ca70869ef5529da80f2d395d551db9bce5ae15f89dd95314ca25124ec2456cf273c56fccd44c55c16e5d04367ddc30ca19f062d7bcd995c66a9f7b7437044391946ff1aa004209a161040ab1778e2f2c00ee482f205b28efba439fcb04ea283f619478d96e340b9cffb37a989ca544e6bb780a2c78901d3fb33738768511a30617afa01d7f4be7e5a1eb872ad44103360ddc190410331280c42a54d829a5d752c796685d00000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000002e05625b835f405a26be5befe6f5f84e3078e8c4776ad18f98e746878b6770749ed44096ce96669a26351476f69665ba7ecc86372625a51fe5e6c49a8bd509169f7000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000106e0802110e0a00000000000022480a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f12240a20bc2ee65d649f9ac73b1c9da9af321df3058202a8873f4547bb1558ac6e39201810012a0c08f295c8f7051090ab958701320962616e64636861696e004add47680935a19b6ec9cedd40423b6729bc989de76cfc6debe51bb5be9735c8278a48fb4cd26f8b3735646a6bd4d234c459b8e6e1543b21ef324d0d3f80999c000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000106e0802110e0a00000000000022480a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f12240a20bc2ee65d649f9ac73b1c9da9af321df3058202a8873f4547bb1558ac6e39201810012a0c08f295c8f70510b5c9938301320962616e64636861696e003892a4f6e094129190e9a6626de612731333b1efd797efe3325903e63508624073f41504a93434ac2ca26e93d5a32ab40edbb870711992f20621b7d6a2f54335000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000106e0802110e0a00000000000022480a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f12240a20bc2ee65d649f9ac73b1c9da9af321df3058202a8873f4547bb1558ac6e39201810012a0c08f295c8f70510c2edf88301320962616e64636861696e0000000000000000000000000000000000000000000000000000000000000007a00000000000000000000000000000000000000000000000000000000000000a0e00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000007ea000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000966726f6d5f7363616e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f000000034254430000000000000064000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000005ef20816000000000000000000000000000000000000000000000000000000005ef2081a00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000000966726f6d5f7363616e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000eb71b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000009b27e34da46bfd69cee4ffcbb512395fa7fa5fc7d5016aabe242f8e99cb82e806af00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000009b2bbd0ad34229408383dc3e8f4eaa1c44481ae7198a8ad5dfa234ed0559f09183c00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000009c3d15486b84f62b5535c0fd46c437489d212911d95501211f1c3a730e32f630eb600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000d00000000000000000000000000000000000000000000000000000000000009c33cdb5cc721bc11d70d6eb33377a26c387ef3c45c064916d6a36659402252ff5600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000009c3121889d461b385a0d77fa5e484f58ad580f126d307526e7ef487c6742a8da9d900000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000003200000000000000000000000000000000000000000000000000000000000009c3562e86bb47132ccc0223eea4c35ef16d0d512086a975f1b473706dd23a5713540000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000700000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000a0d0920a260853246a4ffb39a139a1ac98e3590879f521e03514a38448107996c50",
          { from: bob },
        );

        const {
          clientId,
          requestId,
          ansCount,
          requestTime,
          resolveTime,
          resolveStatus,
          result,
        } = await this.cache.getLatestResponse(this.template);

        [
          clientId,
          requestId,
          ansCount,
          requestTime,
          resolveTime,
          resolveStatus,
          result,
        ]
          .toString()
          .should.eq(
            [
              "from_scan",
              "3",
              "4",
              "1592920086",
              "1592920090",
              "1",
              "0x00000000000eb71b",
            ].toString(),
          );
      });

      it("should be able relay and update the state", async () => {
        await expectRevert(
          this.cache.getLatestResponse(this.template),
          "RESPONSE_NOT_FOUND",
        );

        // initial relay
        await this.cache.relay(
          "0x0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000005e00000000000000000000000000000000000000000000000000000000000000a0e5b14e631db5cdbb2c068be853242e45a091e9c178a5ca180656a12f6afde184472628869fbd308d01fcbd3411df82b10329b57df6c0c44626024e1bb0465b9486fdb04f6871c5d4bd5cb74a4c5a13a537bdd1159f7c38e797d297bc5f19770fbb1f2fd852e790e735ca2d3014f96a2a53c60393e9c6bbf941b9a6dd6a05cf6f97e9cc402179a6714d7a4e34d8ddd21e853780a131455be3cdf89760b972c4b2532fa694879095840619f5e49380612bd296ff7e950eafb66ff654d99ca70869ef5529da80f2d395d551db9bce5ae15f89dd95314ca25124ec2456cf273c56fccd44c55c16e5d04367ddc30ca19f062d7bcd995c66a9f7b7437044391946ff1aa004209a161040ab1778e2f2c00ee482f205b28efba439fcb04ea283f619478d96e340b9cffb37a989ca544e6bb780a2c78901d3fb33738768511a30617afa01d7f4be7e5a1eb872ad44103360ddc190410331280c42a54d829a5d752c796685d00000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000002e05625b835f405a26be5befe6f5f84e3078e8c4776ad18f98e746878b6770749ed44096ce96669a26351476f69665ba7ecc86372625a51fe5e6c49a8bd509169f7000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000106e0802110e0a00000000000022480a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f12240a20bc2ee65d649f9ac73b1c9da9af321df3058202a8873f4547bb1558ac6e39201810012a0c08f295c8f7051090ab958701320962616e64636861696e004add47680935a19b6ec9cedd40423b6729bc989de76cfc6debe51bb5be9735c8278a48fb4cd26f8b3735646a6bd4d234c459b8e6e1543b21ef324d0d3f80999c000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000106e0802110e0a00000000000022480a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f12240a20bc2ee65d649f9ac73b1c9da9af321df3058202a8873f4547bb1558ac6e39201810012a0c08f295c8f70510b5c9938301320962616e64636861696e003892a4f6e094129190e9a6626de612731333b1efd797efe3325903e63508624073f41504a93434ac2ca26e93d5a32ab40edbb870711992f20621b7d6a2f54335000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000106e0802110e0a00000000000022480a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f12240a20bc2ee65d649f9ac73b1c9da9af321df3058202a8873f4547bb1558ac6e39201810012a0c08f295c8f70510c2edf88301320962616e64636861696e0000000000000000000000000000000000000000000000000000000000000007a00000000000000000000000000000000000000000000000000000000000000a0e00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000007ea000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000966726f6d5f7363616e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f000000034254430000000000000064000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000005ef20816000000000000000000000000000000000000000000000000000000005ef2081a00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000000966726f6d5f7363616e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000eb71b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000009b27e34da46bfd69cee4ffcbb512395fa7fa5fc7d5016aabe242f8e99cb82e806af00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000009b2bbd0ad34229408383dc3e8f4eaa1c44481ae7198a8ad5dfa234ed0559f09183c00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000009c3d15486b84f62b5535c0fd46c437489d212911d95501211f1c3a730e32f630eb600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000d00000000000000000000000000000000000000000000000000000000000009c33cdb5cc721bc11d70d6eb33377a26c387ef3c45c064916d6a36659402252ff5600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000009c3121889d461b385a0d77fa5e484f58ad580f126d307526e7ef487c6742a8da9d900000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000003200000000000000000000000000000000000000000000000000000000000009c3562e86bb47132ccc0223eea4c35ef16d0d512086a975f1b473706dd23a5713540000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000700000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000a0d0920a260853246a4ffb39a139a1ac98e3590879f521e03514a38448107996c50",
          { from: bob },
        );

        // relay to update
        await this.cache.relay(
          "0x0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000005e00000000000000000000000000000000000000000000000000000000000000a4f2fb6b7c75032af08bb37d3df59722d54f400bec1f9f14bf840e7711cfc95e12b8e5deda960b2dc8f53406382441e13fc0821322c2b3dae3d8bbb5a4c6326ef087c80a176184bffaf33dcb3618c15e3371727c5b047598647ca3f9aecc4bd305cb1f2fd852e790e735ca2d3014f96a2a53c60393e9c6bbf941b9a6dd6a05cf6f995e24c5fd917b4277cfac3e06fde09ae89231b58b1db51dc69f57b98ec18d9e732fa694879095840619f5e49380612bd296ff7e950eafb66ff654d99ca70869e4c68ced6b571ac169f65570fd568a2bf2821ca8880ec1d7b1b8052beb3bb4adf15798391d1c7d642e97b1a8fd91c11ab50cb91aa780a859fc5d62ca96c338602004209a161040ab1778e2f2c00ee482f205b28efba439fcb04ea283f619478d96e340b9cffb37a989ca544e6bb780a2c78901d3fb33738768511a30617afa01dd991da4d4e69473cc75a4b819f9e07d4956671a6f4a74df4cc16596fcbe6813700000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000002e01297951f2c4fb97690848ce759ce1ab8ad8d972a951a869818828663159a8a6f0871114919ac2b6882b26da7728dd52d150ade92c4f6bca45791f005eb1bbbfe000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000106e0802114f0a00000000000022480a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f12240a203a69db2cf26a980e8f51b3fcb05662eb72389ba98b5a6eec7ab7d51d18f8f04d10012a0c08c896c8f70510b39089e702320962616e64636861696e00d9efd0734b37e70e917d92c83e9b3ec9ab1cd3b1b5c91147310588bae960d25c2c85bb019f10afb9d2062ff880f0fca633a31e9e191f17c33006233281b13185000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000106e0802114f0a00000000000022480a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f12240a203a69db2cf26a980e8f51b3fcb05662eb72389ba98b5a6eec7ab7d51d18f8f04d10012a0c08c896c8f7051086f3c0e602320962616e64636861696e0026be63ade11a107dbef75d5e506f1c64173d8bf1d9508bba19b74d7da222df561d1a861a5541af331fb13a5def77e5c3fbfe70378b134292f5380854817a9e9c000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000106e0802114f0a00000000000022480a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f12240a203a69db2cf26a980e8f51b3fcb05662eb72389ba98b5a6eec7ab7d51d18f8f04d10012a0c08c896c8f7051094b592e602320962616e64636861696e0000000000000000000000000000000000000000000000000000000000000007a00000000000000000000000000000000000000000000000000000000000000a4f00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000009b2000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000966726f6d5f7363616e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f000000034254430000000000000064000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000005ef20a73000000000000000000000000000000000000000000000000000000005ef20a7700000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000000966726f6d5f7363616e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000eb4bf000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000700000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000009b2680ad6cf6e554cee42ff66ecbd120e66009b10284cabc5e02241552c818aae7d00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000009b2bbd0ad34229408383dc3e8f4eaa1c44481ae7198a8ad5dfa234ed0559f09183c00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000009c3d15486b84f62b5535c0fd46c437489d212911d95501211f1c3a730e32f630eb600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000d00000000000000000000000000000000000000000000000000000000000009c33cdb5cc721bc11d70d6eb33377a26c387ef3c45c064916d6a36659402252ff5600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000009c3121889d461b385a0d77fa5e484f58ad580f126d307526e7ef487c6742a8da9d900000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000003200000000000000000000000000000000000000000000000000000000000009c3562e86bb47132ccc0223eea4c35ef16d0d512086a975f1b473706dd23a5713540000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000700000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000a4e240608de388ec1d1100d05d87f2766cc22f98376f955791546074aa8ae6b6d8e",
          { from: bob },
        );

        const {
          clientId,
          requestId,
          ansCount,
          requestTime,
          resolveTime,
          resolveStatus,
          result,
        } = await this.cache.getLatestResponse(this.template);

        [
          clientId,
          requestId,
          ansCount,
          requestTime,
          resolveTime,
          resolveStatus,
          result,
        ]
          .toString()
          .should.eq(
            [
              "from_scan",
              "4",
              "4",
              "1592920691",
              "1592920695",
              "1",
              "0x00000000000eb4bf",
            ].toString(),
          );
      });

      it("should not be able to submit old request", async () => {
        await expectRevert(
          this.cache.getLatestResponse(this.template),
          "RESPONSE_NOT_FOUND",
        );

        // initial relay
        await this.cache.relay(
          "0x0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000005e00000000000000000000000000000000000000000000000000000000000000a4f2fb6b7c75032af08bb37d3df59722d54f400bec1f9f14bf840e7711cfc95e12b8e5deda960b2dc8f53406382441e13fc0821322c2b3dae3d8bbb5a4c6326ef087c80a176184bffaf33dcb3618c15e3371727c5b047598647ca3f9aecc4bd305cb1f2fd852e790e735ca2d3014f96a2a53c60393e9c6bbf941b9a6dd6a05cf6f995e24c5fd917b4277cfac3e06fde09ae89231b58b1db51dc69f57b98ec18d9e732fa694879095840619f5e49380612bd296ff7e950eafb66ff654d99ca70869e4c68ced6b571ac169f65570fd568a2bf2821ca8880ec1d7b1b8052beb3bb4adf15798391d1c7d642e97b1a8fd91c11ab50cb91aa780a859fc5d62ca96c338602004209a161040ab1778e2f2c00ee482f205b28efba439fcb04ea283f619478d96e340b9cffb37a989ca544e6bb780a2c78901d3fb33738768511a30617afa01dd991da4d4e69473cc75a4b819f9e07d4956671a6f4a74df4cc16596fcbe6813700000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000002e01297951f2c4fb97690848ce759ce1ab8ad8d972a951a869818828663159a8a6f0871114919ac2b6882b26da7728dd52d150ade92c4f6bca45791f005eb1bbbfe000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000106e0802114f0a00000000000022480a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f12240a203a69db2cf26a980e8f51b3fcb05662eb72389ba98b5a6eec7ab7d51d18f8f04d10012a0c08c896c8f70510b39089e702320962616e64636861696e00d9efd0734b37e70e917d92c83e9b3ec9ab1cd3b1b5c91147310588bae960d25c2c85bb019f10afb9d2062ff880f0fca633a31e9e191f17c33006233281b13185000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000106e0802114f0a00000000000022480a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f12240a203a69db2cf26a980e8f51b3fcb05662eb72389ba98b5a6eec7ab7d51d18f8f04d10012a0c08c896c8f7051086f3c0e602320962616e64636861696e0026be63ade11a107dbef75d5e506f1c64173d8bf1d9508bba19b74d7da222df561d1a861a5541af331fb13a5def77e5c3fbfe70378b134292f5380854817a9e9c000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000106e0802114f0a00000000000022480a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f12240a203a69db2cf26a980e8f51b3fcb05662eb72389ba98b5a6eec7ab7d51d18f8f04d10012a0c08c896c8f7051094b592e602320962616e64636861696e0000000000000000000000000000000000000000000000000000000000000007a00000000000000000000000000000000000000000000000000000000000000a4f00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000009b2000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000966726f6d5f7363616e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f000000034254430000000000000064000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000005ef20a73000000000000000000000000000000000000000000000000000000005ef20a7700000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000000966726f6d5f7363616e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000eb4bf000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000700000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000009b2680ad6cf6e554cee42ff66ecbd120e66009b10284cabc5e02241552c818aae7d00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000009b2bbd0ad34229408383dc3e8f4eaa1c44481ae7198a8ad5dfa234ed0559f09183c00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000009c3d15486b84f62b5535c0fd46c437489d212911d95501211f1c3a730e32f630eb600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000d00000000000000000000000000000000000000000000000000000000000009c33cdb5cc721bc11d70d6eb33377a26c387ef3c45c064916d6a36659402252ff5600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000009c3121889d461b385a0d77fa5e484f58ad580f126d307526e7ef487c6742a8da9d900000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000003200000000000000000000000000000000000000000000000000000000000009c3562e86bb47132ccc0223eea4c35ef16d0d512086a975f1b473706dd23a5713540000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000700000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000a4e240608de388ec1d1100d05d87f2766cc22f98376f955791546074aa8ae6b6d8e",
          { from: bob },
        );

        // relay an older request
        await expectRevert(
          this.cache.relay(
            "0x0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000005e00000000000000000000000000000000000000000000000000000000000000a0e5b14e631db5cdbb2c068be853242e45a091e9c178a5ca180656a12f6afde184472628869fbd308d01fcbd3411df82b10329b57df6c0c44626024e1bb0465b9486fdb04f6871c5d4bd5cb74a4c5a13a537bdd1159f7c38e797d297bc5f19770fbb1f2fd852e790e735ca2d3014f96a2a53c60393e9c6bbf941b9a6dd6a05cf6f97e9cc402179a6714d7a4e34d8ddd21e853780a131455be3cdf89760b972c4b2532fa694879095840619f5e49380612bd296ff7e950eafb66ff654d99ca70869ef5529da80f2d395d551db9bce5ae15f89dd95314ca25124ec2456cf273c56fccd44c55c16e5d04367ddc30ca19f062d7bcd995c66a9f7b7437044391946ff1aa004209a161040ab1778e2f2c00ee482f205b28efba439fcb04ea283f619478d96e340b9cffb37a989ca544e6bb780a2c78901d3fb33738768511a30617afa01d7f4be7e5a1eb872ad44103360ddc190410331280c42a54d829a5d752c796685d00000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000002e05625b835f405a26be5befe6f5f84e3078e8c4776ad18f98e746878b6770749ed44096ce96669a26351476f69665ba7ecc86372625a51fe5e6c49a8bd509169f7000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000106e0802110e0a00000000000022480a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f12240a20bc2ee65d649f9ac73b1c9da9af321df3058202a8873f4547bb1558ac6e39201810012a0c08f295c8f7051090ab958701320962616e64636861696e004add47680935a19b6ec9cedd40423b6729bc989de76cfc6debe51bb5be9735c8278a48fb4cd26f8b3735646a6bd4d234c459b8e6e1543b21ef324d0d3f80999c000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000106e0802110e0a00000000000022480a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f12240a20bc2ee65d649f9ac73b1c9da9af321df3058202a8873f4547bb1558ac6e39201810012a0c08f295c8f70510b5c9938301320962616e64636861696e003892a4f6e094129190e9a6626de612731333b1efd797efe3325903e63508624073f41504a93434ac2ca26e93d5a32ab40edbb870711992f20621b7d6a2f54335000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000106e0802110e0a00000000000022480a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f12240a20bc2ee65d649f9ac73b1c9da9af321df3058202a8873f4547bb1558ac6e39201810012a0c08f295c8f70510c2edf88301320962616e64636861696e0000000000000000000000000000000000000000000000000000000000000007a00000000000000000000000000000000000000000000000000000000000000a0e00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000007ea000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000966726f6d5f7363616e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f000000034254430000000000000064000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000005ef20816000000000000000000000000000000000000000000000000000000005ef2081a00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000000966726f6d5f7363616e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000eb71b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000009b27e34da46bfd69cee4ffcbb512395fa7fa5fc7d5016aabe242f8e99cb82e806af00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000009b2bbd0ad34229408383dc3e8f4eaa1c44481ae7198a8ad5dfa234ed0559f09183c00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000009c3d15486b84f62b5535c0fd46c437489d212911d95501211f1c3a730e32f630eb600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000d00000000000000000000000000000000000000000000000000000000000009c33cdb5cc721bc11d70d6eb33377a26c387ef3c45c064916d6a36659402252ff5600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000009c3121889d461b385a0d77fa5e484f58ad580f126d307526e7ef487c6742a8da9d900000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000003200000000000000000000000000000000000000000000000000000000000009c3562e86bb47132ccc0223eea4c35ef16d0d512086a975f1b473706dd23a5713540000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000700000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000a0d0920a260853246a4ffb39a139a1ac98e3590879f521e03514a38448107996c50",
            { from: bob },
          ),
          "FAIL_LATEST_REQUEST_SHOULD_BE_NEWEST",
        );
      });

      it("should not be able to submit an unresolved request", async () => {
        await expectRevert(
          this.cache.getLatestResponse(this.template),
          "RESPONSE_NOT_FOUND",
        );

        // relay a request with resolve status = 2
        await expectRevert(
          this.cache.relay(
            "0x0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000005e00000000000000000000000000000000000000000000000000000000000019e8c10d1bb5a23a0ed3668df0b2a4257b46225db7391c56e940ad95536d0e5a75d79f4be0eeff9a2e52e11da7591c029cee08ecfe59435dbd731679905a94c2bb53b8fdacf87d1d46d85ee2585ca5a304a2a499080b8c7460f5efac7d053911fbee6b1f2fd852e790e735ca2d3014f96a2a53c60393e9c6bbf941b9a6dd6a05cf6f9df898ce21b5981ca9994759bb2b77204496e9d062a080b52c2b38b8d8df0f55232fa694879095840619f5e49380612bd296ff7e950eafb66ff654d99ca70869e8f7beb334b2ff0c5c176144edbbfe9426cdb41fea466d43d0b89e2515f9e5a5170e961a346803fa2198490f4ded2683e31384b2a37725e719ae7ca164eb22ceb004209a161040ab1778e2f2c00ee482f205b28efba439fcb04ea283f619478d96e340b9cffb37a989ca544e6bb780a2c78901d3fb33738768511a30617afa01d0efe3e12f46363c7779140d4ce659925db52f19053e114d7cc4efd666b37f79f00000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000002e04ed98be18e8daa17dface914d1a3cc1dfa9f750e49288eb0f174e5807d789cf4552ea28fd59148a5885bdc2d703e2899754a7ebb08e6599fdfc43845c714c867000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000106e0802118c9e01000000000022480a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f12240a20ee95cbd137a9b459e382b317a6342087da4ddd9e4215fbbb69cec3fe4b82028b10012a0c08b3c2d0f70510e3f7da9c01320962616e64636861696e0074e9db581a49405c8982e3ecaa81e5ef0a7e2ebbfa72c758778c3070380de2da6ace14389fd984502d1ab1273d3f678dbb5a988ceeb4912aa9e93e776ec0c110000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000106e0802118c9e01000000000022480a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f12240a20ee95cbd137a9b459e382b317a6342087da4ddd9e4215fbbb69cec3fe4b82028b10012a0c08b3c2d0f70510cfd6959e01320962616e64636861696e007a45a72854b0a9a6a615c55efafc7daa6366aee86700e15f1f45e82c5644e4dc7545bdd1dd0d6b5efadd5816b400be55b61f5b9c7127be2521009f43b092112d000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000106e0802118c9e01000000000022480a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f12240a20ee95cbd137a9b459e382b317a6342087da4ddd9e4215fbbb69cec3fe4b82028b10012a0c08b3c2d0f70510d9fa9da001320962616e64636861696e0000000000000000000000000000000000000000000000000000000000000007800000000000000000000000000000000000000000000000000000000000019e8c00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000f8d6000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000d00000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000966726f6d5f7363616e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e0000000342544300000003555344000000046d65616e0000000000000064000000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000090000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000005ef34682000000000000000000000000000000000000000000000000000000005ef3468600000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000000966726f6d5f7363616e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000f937a181077d74a00d1c4888d3957b673b7ac5265cef6642b398ee81564e0a02a866000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000f93792dbf6c1d5523fedfec04d0d8cf33992bc2f5a748d935cafaa022d14da11701900000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000d000000000000000000000000000000000000000000000000000000000000f948bea043e9a22ced8e9149097d6f7c9c3d719280d05fcf127cb7727fdb8a5c4f7f000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000f9483be0e603fd2d50e9adff89e384c1586933110ef6320849658961f119a6fb731e000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000f948121889d461b385a0d77fa5e484f58ad580f126d307526e7ef487c6742a8da9d9000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000070000000000000000000000000000000000000000000000000000000000000039000000000000000000000000000000000000000000000000000000000000f948562e86bb47132ccc0223eea4c35ef16d0d512086a975f1b473706dd23a57135400000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000007a0000000000000000000000000000000000000000000000000000000000019e8bcc921a62033387ad80d703b9fccf04e1d501b4e7d8e006a79d9d91de032092f3",
            { from: bob },
          ),
          "FAIL_REQUEST_IS_NOT_SUCCESSFULLY_RESOLVED",
        );
      });

      it("should be able relay and consume state by consumer contract", async () => {
        // consume and fail
        await expectRevert(this.consumer.consumeCache(), "RESPONSE_NOT_FOUND");

        const {
          clientId,
          requestId,
          ansCount,
          requestTime,
          resolveTime,
          resolveStatus,
          result,
        } = await this.consumer.latestRes();

        [
          clientId,
          requestId.toString(),
          ansCount.toString(),
          requestTime.toString(),
          resolveTime.toString(),
          resolveStatus.toString(),
          result,
        ]
          .toString()
          .should.eq(["", "0", "0", "0", "0", "0", null].toString());

        // relay
        await this.cache.relay(
          "0x0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000005e00000000000000000000000000000000000000000000000000000000000000a0e5b14e631db5cdbb2c068be853242e45a091e9c178a5ca180656a12f6afde184472628869fbd308d01fcbd3411df82b10329b57df6c0c44626024e1bb0465b9486fdb04f6871c5d4bd5cb74a4c5a13a537bdd1159f7c38e797d297bc5f19770fbb1f2fd852e790e735ca2d3014f96a2a53c60393e9c6bbf941b9a6dd6a05cf6f97e9cc402179a6714d7a4e34d8ddd21e853780a131455be3cdf89760b972c4b2532fa694879095840619f5e49380612bd296ff7e950eafb66ff654d99ca70869ef5529da80f2d395d551db9bce5ae15f89dd95314ca25124ec2456cf273c56fccd44c55c16e5d04367ddc30ca19f062d7bcd995c66a9f7b7437044391946ff1aa004209a161040ab1778e2f2c00ee482f205b28efba439fcb04ea283f619478d96e340b9cffb37a989ca544e6bb780a2c78901d3fb33738768511a30617afa01d7f4be7e5a1eb872ad44103360ddc190410331280c42a54d829a5d752c796685d00000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000002e05625b835f405a26be5befe6f5f84e3078e8c4776ad18f98e746878b6770749ed44096ce96669a26351476f69665ba7ecc86372625a51fe5e6c49a8bd509169f7000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000106e0802110e0a00000000000022480a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f12240a20bc2ee65d649f9ac73b1c9da9af321df3058202a8873f4547bb1558ac6e39201810012a0c08f295c8f7051090ab958701320962616e64636861696e004add47680935a19b6ec9cedd40423b6729bc989de76cfc6debe51bb5be9735c8278a48fb4cd26f8b3735646a6bd4d234c459b8e6e1543b21ef324d0d3f80999c000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000106e0802110e0a00000000000022480a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f12240a20bc2ee65d649f9ac73b1c9da9af321df3058202a8873f4547bb1558ac6e39201810012a0c08f295c8f70510b5c9938301320962616e64636861696e003892a4f6e094129190e9a6626de612731333b1efd797efe3325903e63508624073f41504a93434ac2ca26e93d5a32ab40edbb870711992f20621b7d6a2f54335000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000106e0802110e0a00000000000022480a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f12240a20bc2ee65d649f9ac73b1c9da9af321df3058202a8873f4547bb1558ac6e39201810012a0c08f295c8f70510c2edf88301320962616e64636861696e0000000000000000000000000000000000000000000000000000000000000007a00000000000000000000000000000000000000000000000000000000000000a0e00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000007ea000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000966726f6d5f7363616e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f000000034254430000000000000064000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000005ef20816000000000000000000000000000000000000000000000000000000005ef2081a00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000000966726f6d5f7363616e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000eb71b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000009b27e34da46bfd69cee4ffcbb512395fa7fa5fc7d5016aabe242f8e99cb82e806af00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000009b2bbd0ad34229408383dc3e8f4eaa1c44481ae7198a8ad5dfa234ed0559f09183c00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000009c3d15486b84f62b5535c0fd46c437489d212911d95501211f1c3a730e32f630eb600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000d00000000000000000000000000000000000000000000000000000000000009c33cdb5cc721bc11d70d6eb33377a26c387ef3c45c064916d6a36659402252ff5600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000009c3121889d461b385a0d77fa5e484f58ad580f126d307526e7ef487c6742a8da9d900000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000003200000000000000000000000000000000000000000000000000000000000009c3562e86bb47132ccc0223eea4c35ef16d0d512086a975f1b473706dd23a5713540000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000700000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000a0d0920a260853246a4ffb39a139a1ac98e3590879f521e03514a38448107996c50",
          { from: bob },
        );

        // consume again
        await this.consumer.consumeCache();

        const x = await this.consumer.latestRes();

        [
          x.clientId,
          x.requestId,
          x.ansCount,
          x.requestTime,
          x.resolveTime,
          x.resolveStatus,
          x.result,
        ]
          .toString()
          .should.eq(
            [
              "from_scan",
              "3",
              "4",
              "1592920086",
              "1592920090",
              "1",
              "0x00000000000eb71b",
            ].toString(),
          );
      });
    },
  );

  context("Relay Multiple Requests", () => {
    beforeEach(async () => {
      this.templates = [
        [
          "from_scan",
          "2",
          "0x00000004474f4f4700000010324b4d43424c415a4d3554453256504700000000000003e8",
          "1",
          "1",
        ],
        [
          "from_scan",
          "2",
          "0x000000044141504c00000010324b4d43424c415a4d3554453256504700000000000003e8",
          "1",
          "1",
        ],
        [
          "from_scan",
          "2",
          "0x00000002464200000010324b4d43424c415a4d3554453256504700000000000003e8",
          "1",
          "1",
        ],
      ];

      this.cache = await CacheBridge.new([
        ["0xaAA22E077492CbaD414098EBD98AA8dc1C7AE8D9", 100],
      ]);

      this.consumer = await BridgeCacheConsumerMock.new(
        this.cache.address,
        this.templates[0],
        { from: alice },
      );
    });

    it("should be able to submit multiple requests and then consume them correctly", async () => {
      // consume and fail
      await this.consumer.setRequestTemplete(this.templates[0]);
      await expectRevert(this.consumer.consumeCache(), "RESPONSE_NOT_FOUND");

      // consume and fail
      await this.consumer.setRequestTemplete(this.templates[1]);
      await expectRevert(this.consumer.consumeCache(), "RESPONSE_NOT_FOUND");

      // consume and fail
      await this.consumer.setRequestTemplete(this.templates[2]);
      await expectRevert(this.consumer.consumeCache(), "RESPONSE_NOT_FOUND");

      await this.cache.relayMulti(
        "0x00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000380000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000002E445CD72E61F5D79ECC26F8CA024FB86D3A6A925071DDF73CB79D1BBAEA3C5132C47359DC797788AA7A77A27B8B40BF23F5EF60594E34253373DDFB76251240C43866A2417EB63733CC9B7A5CB89EDC98F308EE066FFE6E59E0C6CBE22B700704E2B6A7E0F44ED9C179A47A40F93D5824189A5426D6C3F77692DE28E50E20A33DDAF86E0275A883BDCA2276CC1FE523F4E43C50C5612EB996623D287F80B84CFDA32FA694879095840619F5E49380612BD296FF7E950EAFB66FF654D99CA70869E48DFB8B1F245FAB852685BEEAB33EBB09CD93EA77BDDD9B73AEB833FC2FC028B1EF4C4CD033DCB00C0B471C30B35ABC13C2A8B682D70CCA2CC74DFBBEE46CDFAA54CCB0556B3BD0C34805C986FED66F1BDF3FC989BA01F2F34470EE3A7DA71016E340B9CFFB37A989CA544E6BB780A2C78901D3FB33738768511A30617AFA01D0CF1E6ECE60E49D19BB57C1A432E805F39BB4F65C366741E4F03FA54FBD9071400000000000000000000000000000000000000000000000000000000000001A0000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000203D2DD609088F4A660225913296A5D392051FCCC6CCBA9C74E46DE2A5E6CBF3D7733483953F4283ADF7DEE7D082601B641B14A85B71D4FE7D6584BF2FED620904000000000000000000000000000000000000000000000000000000000000001B00000000000000000000000000000000000000000000000000000000000000A000000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000106E080211E40200000000000022480A2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003F12240A2060F3ED6948B113B8B528C6F79D33F5A40544AD5330132A2ABFD47A18A147D84910012A0C0890D2D9FA0510C8BD9DD901320962616E64636861696E000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000007A00000000000000000000000000000000000000000000000000000000000000EE0000000000000000000000000000000000000000000000000000000000000072000000000000000000000000000000000000000000000000000000000000002E400000000000000000000000000000000000000000000000000000000000000A000000000000000000000000000000000000000000000000000000000000001E000000000000000000000000000000000000000000000000000000000000001CE000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000000A0000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000966726F6D5F7363616E0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002200000002464200000010324B4D43424C415A4D3554453256504700000000000003E800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000005F566759000000000000000000000000000000000000000000000000000000005F56675C00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000000966726F6D5F7363616E00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000004506A000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000002A2C1302062844B84E96DB63A6924AA593F66A9E8A535CF657DE4D1F86CFEF8058B00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000002A2301E07C9ED7015E98CBC234AEB87003C05AF21F4273EEE8C3F55BF668AECB4D000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000002A2B6936B0BB87A5579BD57C790C2A191ECF70C707F2C7493356AFD32489C48B07C00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000C00000000000000000000000000000000000000000000000000000000000002A261E55C6C45B1A9E9B86C32BB19BF819A7CB684AABD7FA4BC8C87792DAE52D38F00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000001400000000000000000000000000000000000000000000000000000000000002A25D52D5033592D37ECCA65B227BF3AF502967E0833BB867DBBE6AA0848285BFEB00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000002A00000000000000000000000000000000000000000000000000000000000002E33DE917D101D39159FB448360B702BC1C8778975B81CEBC8BE73C7F8DA3DE3A79000000000000000000000000000000000000000000000000000000000000072000000000000000000000000000000000000000000000000000000000000002E400000000000000000000000000000000000000000000000000000000000000A000000000000000000000000000000000000000000000000000000000000001E00000000000000000000000000000000000000000000000000000000000000247000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000000A0000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000966726F6D5F7363616E0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002400000004474F4F4700000010324B4D43424C415A4D3554453256504700000000000003E80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000005F566816000000000000000000000000000000000000000000000000000000005F56681900000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000000966726F6D5F7363616E000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080000000000184700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000002A21646BAB59AD79C62A66123C7CBF0B1CE8830336C5F3CB5CC689CC45C5BAA140C00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000002A28C3D3FC25F23B7F63ED18C8900FC40582E7ED488B71C7FE19126DCCCDCE08D7600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000002A2B6936B0BB87A5579BD57C790C2A191ECF70C707F2C7493356AFD32489C48B07C00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000C00000000000000000000000000000000000000000000000000000000000002A261E55C6C45B1A9E9B86C32BB19BF819A7CB684AABD7FA4BC8C87792DAE52D38F00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000001400000000000000000000000000000000000000000000000000000000000002A25D52D5033592D37ECCA65B227BF3AF502967E0833BB867DBBE6AA0848285BFEB00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000002A00000000000000000000000000000000000000000000000000000000000002E33DE917D101D39159FB448360B702BC1C8778975B81CEBC8BE73C7F8DA3DE3A79000000000000000000000000000000000000000000000000000000000000072000000000000000000000000000000000000000000000000000000000000002E400000000000000000000000000000000000000000000000000000000000000A000000000000000000000000000000000000000000000000000000000000001E000000000000000000000000000000000000000000000000000000000000002A2000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000000A0000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000966726F6D5F7363616E00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000024000000044141504C00000010324B4D43424C415A4D3554453256504700000000000003E80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000005F5668A4000000000000000000000000000000000000000000000000000000005F5668A700000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000000966726F6D5F7363616E00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000001D880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000002A2420CE1DDED95E4D5240EEB397AAC8C82C372028466EBC5DC3919A0D22C75EDE800000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000002A28C3D3FC25F23B7F63ED18C8900FC40582E7ED488B71C7FE19126DCCCDCE08D7600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000002A2B6936B0BB87A5579BD57C790C2A191ECF70C707F2C7493356AFD32489C48B07C00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000C00000000000000000000000000000000000000000000000000000000000002A261E55C6C45B1A9E9B86C32BB19BF819A7CB684AABD7FA4BC8C87792DAE52D38F00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000001400000000000000000000000000000000000000000000000000000000000002A25D52D5033592D37ECCA65B227BF3AF502967E0833BB867DBBE6AA0848285BFEB00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000002A00000000000000000000000000000000000000000000000000000000000002E33DE917D101D39159FB448360B702BC1C8778975B81CEBC8BE73C7F8DA3DE3A79",
        { from: bob },
      );
      const expects = [
        `from_scan,2,1,1599498262,1599498265,1,0x0000000000184700`,
        `from_scan,3,1,1599498404,1599498407,1,0x000000000001d880`,
        `from_scan,1,1,1599498073,1599498076,1,0x000000000004506a`,
      ];

      for (let i = 0; i < expects.length; i++) {
        /// Try to consume cache i
        await this.consumer.setRequestTemplete(this.templates[i]);
        await this.consumer.consumeCache();
        const {
          clientId,
          requestId,
          ansCount,
          requestTime,
          resolveTime,
          resolveStatus,
          result,
        } = await this.consumer.latestRes();

        [
          clientId,
          requestId,
          ansCount,
          requestTime,
          resolveTime,
          resolveStatus,
          result,
        ]
          .toString()
          .should.eq(expects[i]);
      }
    });

    it("should not be able to submit multiple requests with the same request packet, but not sort by resolve_time in ascending order", async () => {
      /// Submit array of requests [request id=1, request id=1]
      await expectRevert(
        this.cache.relayMulti(
          "0x000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000003800000000000000000000000000000000000000000000000000000000000000320000000000000000000000000000000000000000000000000000000000000003C5405D74858AA1FD143E7921F414860F49BA0008BF68B8E3AC7D5DD7D8A3124D7973385AA64302E5DBF76D33D49215A7AE02B9DD647EAF5622065869CCBB9B2F93A4DECED4082A278086EE7877B80A6C6E8538E389682ED5DC32439AB476C17392B6A7E0F44ED9C179A47A40F93D5824189A5426D6C3F77692DE28E50E20A33DDDA76B18E19DA189576E48DB61A45CF91330A1E33B214EAC0276F0B2C9AE942A832FA694879095840619F5E49380612BD296FF7E950EAFB66FF654D99CA70869EA80A4A62959B092B27CCB35095002B47B2E3FD9816D1138839F6277AFE92C2CF4BB65BCBB6AAC083DC8B549BC5A01D872659D603AAF5059D4056D4F9109E5BBAA54CCB0556B3BD0C34805C986FED66F1BDF3FC989BA01F2F34470EE3A7DA71016E340B9CFFB37A989CA544E6BB780A2C78901D3FB33738768511A30617AFA01D0CF1E6ECE60E49D19BB57C1A432E805F39BB4F65C366741E4F03FA54FBD9071400000000000000000000000000000000000000000000000000000000000001A0000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000206328339D03C727112E0B396CD818A3C536751B1DBAAA3C2A8AD342250C8618B40BF8F7C7D64EE331DB69922E232DDD30E31A648640FAD1E7C60D7357608B2424000000000000000000000000000000000000000000000000000000000000001B00000000000000000000000000000000000000000000000000000000000000A000000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000106E0802113C0000000000000022480A2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003F12240A20DB8424493F409D65BD4F304E25BA6F3555C97DC7FAFBA497233B6B6432DC58A310012A0C08F393DCFA0510889EDADD01320962616E64636861696E000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000007800000000000000000000000000000000000000000000000000000000000000720000000000000000000000000000000000000000000000000000000000000003C00000000000000000000000000000000000000000000000000000000000000A000000000000000000000000000000000000000000000000000000000000001E00000000000000000000000000000000000000000000000000000000000000035000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000000A0000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000966726F6D5F7363616E0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002200000002464200000010324B4D43424C415A4D3554453256504700000000000003E800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000005F5709E3000000000000000000000000000000000000000000000000000000005F5709E600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000000966726F6D5F7363616E00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000004506A0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000003596A3B83847DE33ECA143A16533606DC426BBCC93E252670ED4C3175F97AADED80000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000035FECD06345B284A6B7BCDDD5751F6674CDE067C46D04AA98D6C61184553EA3EBC000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000003579CEF6DEB76308A12C43E37E9E19BA08A54C7EC18CA06E867897686C7A84F48800000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000A000000000000000000000000000000000000000000000000000000000000003561E55C6C45B1A9E9B86C32BB19BF819A7CB684AABD7FA4BC8C87792DAE52D38F00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000355D52D5033592D37ECCA65B227BF3AF502967E0833BB867DBBE6AA0848285BFEB000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000024000000000000000000000000000000000000000000000000000000000000003B0600E727A540DB77880317C5AA92535EE8AE24A6D2E1BA5CAE630C894902E31C0000000000000000000000000000000000000000000000000000000000000720000000000000000000000000000000000000000000000000000000000000003C00000000000000000000000000000000000000000000000000000000000000A000000000000000000000000000000000000000000000000000000000000001E00000000000000000000000000000000000000000000000000000000000000035000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000000A0000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000966726F6D5F7363616E0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002200000002464200000010324B4D43424C415A4D3554453256504700000000000003E800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000005F5709E3000000000000000000000000000000000000000000000000000000005F5709E600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000000966726F6D5F7363616E00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000004506A0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000003596A3B83847DE33ECA143A16533606DC426BBCC93E252670ED4C3175F97AADED80000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000035FECD06345B284A6B7BCDDD5751F6674CDE067C46D04AA98D6C61184553EA3EBC000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000003579CEF6DEB76308A12C43E37E9E19BA08A54C7EC18CA06E867897686C7A84F48800000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000A000000000000000000000000000000000000000000000000000000000000003561E55C6C45B1A9E9B86C32BB19BF819A7CB684AABD7FA4BC8C87792DAE52D38F00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000355D52D5033592D37ECCA65B227BF3AF502967E0833BB867DBBE6AA0848285BFEB000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000024000000000000000000000000000000000000000000000000000000000000003B0600E727A540DB77880317C5AA92535EE8AE24A6D2E1BA5CAE630C894902E31C",
          { from: bob },
        ),
        "FAIL_LATEST_REQUEST_SHOULD_BE_NEWEST",
      );

      /// Submit array of requests [request id=2, request id=1]
      await expectRevert(
        this.cache.relayMulti(
          "0x00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000380000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000000AAAE59886F86BD918F4331EFA65AABC7DC3182626E2A3059EFE7496843A32921A6D4919D75075DF8AC68F7ABF8922869BCA2A70CE66939B25BB467CFB97CD9A43E6D8601CCBC5F14F75A9347EC217D29FC37646722DAE89C79324D2C01FE0E24D12B6A7E0F44ED9C179A47A40F93D5824189A5426D6C3F77692DE28E50E20A33DDD49C31EFE830305640B306A91081A0344D55888B984A2D4F0E6B443EFF6580BB32FA694879095840619F5E49380612BD296FF7E950EAFB66FF654D99CA70869EAF7C4045D27646DEEF89FE858CF6945CB562EC1288157B0922887F95508CAC3C27FB2A0AF5C4BEE9710DD6EFA683ED6776EBF69E82638EBFBC4281FEB4990672A54CCB0556B3BD0C34805C986FED66F1BDF3FC989BA01F2F34470EE3A7DA71016E340B9CFFB37A989CA544E6BB780A2C78901D3FB33738768511A30617AFA01D0CF1E6ECE60E49D19BB57C1A432E805F39BB4F65C366741E4F03FA54FBD9071400000000000000000000000000000000000000000000000000000000000001A000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020695BD7A98516CF35D059872ED2A56A9D0C863BDB0DB12FB37D23F23A964E7649180DD0D8F26F3D88A4DB04683B65EB3BD94784267CA774828F0C32F784F73938000000000000000000000000000000000000000000000000000000000000001C00000000000000000000000000000000000000000000000000000000000000A000000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000106E080211AA0000000000000022480A2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003F12240A2081A0E7DA8256FF549D9AE6B5699966820D4DEBC6A2C84C3442D8F6DE80307C8310012A0C089F95DCFA0510B09FB2EF02320962616E64636861696E00000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000780000000000000000000000000000000000000000000000000000000000000072000000000000000000000000000000000000000000000000000000000000000AA00000000000000000000000000000000000000000000000000000000000000A000000000000000000000000000000000000000000000000000000000000001E00000000000000000000000000000000000000000000000000000000000000086000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000000A0000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000966726F6D5F7363616E0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002200000002464200000010324B4D43424C415A4D3554453256504700000000000003E800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000005F570A62000000000000000000000000000000000000000000000000000000005F570A6500000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000000966726F6D5F7363616E00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000004506A00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000086E761803AF2FBF57DA4E0FB7C027C29E711A85343B2F6F7CB9BD560E0518CB73F000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000008696A3B83847DE33ECA143A16533606DC426BBCC93E252670ED4C3175F97AADED80000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000070000000000000000000000000000000000000000000000000000000000000086E8AD34B2F5626C1BF40A98F0F71990914A14AB1DA57D9C507D46DF05E3AB395800000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000B000000000000000000000000000000000000000000000000000000000000008661E55C6C45B1A9E9B86C32BB19BF819A7CB684AABD7FA4BC8C87792DAE52D38F00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000001300000000000000000000000000000000000000000000000000000000000000865D52D5033592D37ECCA65B227BF3AF502967E0833BB867DBBE6AA0848285BFEB00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000002700000000000000000000000000000000000000000000000000000000000000A917E3A83BD221E745C0ED9A99038389973C5E7708A3A3FE8C4C9650FEC3BCCC46000000000000000000000000000000000000000000000000000000000000072000000000000000000000000000000000000000000000000000000000000000AA00000000000000000000000000000000000000000000000000000000000000A000000000000000000000000000000000000000000000000000000000000001E00000000000000000000000000000000000000000000000000000000000000035000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000000A0000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000966726F6D5F7363616E0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002200000002464200000010324B4D43424C415A4D3554453256504700000000000003E800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000005F5709E3000000000000000000000000000000000000000000000000000000005F5709E600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000000966726F6D5F7363616E00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000004506A00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000086D6840C5D455176BFD3FA8BAC27E7888EF32B70A738D948B4380403EDB369D773000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000008696A3B83847DE33ECA143A16533606DC426BBCC93E252670ED4C3175F97AADED80000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000070000000000000000000000000000000000000000000000000000000000000086E8AD34B2F5626C1BF40A98F0F71990914A14AB1DA57D9C507D46DF05E3AB395800000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000B000000000000000000000000000000000000000000000000000000000000008661E55C6C45B1A9E9B86C32BB19BF819A7CB684AABD7FA4BC8C87792DAE52D38F00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000001300000000000000000000000000000000000000000000000000000000000000865D52D5033592D37ECCA65B227BF3AF502967E0833BB867DBBE6AA0848285BFEB00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000002700000000000000000000000000000000000000000000000000000000000000A917E3A83BD221E745C0ED9A99038389973C5E7708A3A3FE8C4C9650FEC3BCCC46",
          { from: bob },
        ),
        "FAIL_LATEST_REQUEST_SHOULD_BE_NEWEST",
      );
    });

    it("should not be able to submit multiple requests with a request that is not successfully resolved", async () => {
      /// Submit array of requests [request id=2, request id=3 <- not successfully resolved ]
      await expectRevert(
        this.cache.relayMulti(
          "0x00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000380000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000001044535EB77A01165A6DE67E8760EA7E03EB7B394738B4AE91DF8FBD0553B3B674955FFC2AE2E3FA7A61EF9E023913F24DF3BF32315DE3C5DFFAE0BB0C8DE7E6901279B579615224BB26F0296E0E3727507337FE9DA0CCBB22567CDFDE2B66852002B6A7E0F44ED9C179A47A40F93D5824189A5426D6C3F77692DE28E50E20A33DD73D2EA2E64DF00EB0668040362184D8D6CF9A21621878E0FC278DBE79993BA9E32FA694879095840619F5E49380612BD296FF7E950EAFB66FF654D99CA70869E1D695E4CEF5382DF2898B3E9B240DDE62C66F49A248637818C2FBA22E0337061A3CB0248317D73D664C9CC9555DED799EC7968658C71C03E6F5EAAA3942E9052A54CCB0556B3BD0C34805C986FED66F1BDF3FC989BA01F2F34470EE3A7DA71016E340B9CFFB37A989CA544E6BB780A2C78901D3FB33738768511A30617AFA01D0CF1E6ECE60E49D19BB57C1A432E805F39BB4F65C366741E4F03FA54FBD9071400000000000000000000000000000000000000000000000000000000000001A00000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002053528E4B4192D56031F9608CB6CF518D615AD09C4F202D6907DFD3CF4E6ADAE1105B273F0937B6EA86789152B5BC561C18ED0EFC324D6EC3CE698123C988F707000000000000000000000000000000000000000000000000000000000000001C00000000000000000000000000000000000000000000000000000000000000A000000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000106E080211040100000000000022480A2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003F12240A207B379B819800C4DACF87F8E13FE52B230AD22756E0F58BA0A214F4CDCD010B5010012A0C08AC96DCFA0510A08F888702320962616E64636861696E000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000007800000000000000000000000000000000000000000000000000000000000000720000000000000000000000000000000000000000000000000000000000000010400000000000000000000000000000000000000000000000000000000000000A000000000000000000000000000000000000000000000000000000000000001E00000000000000000000000000000000000000000000000000000000000000086000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000000A0000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000966726F6D5F7363616E0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002200000002464200000010324B4D43424C415A4D3554453256504700000000000003E800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000005F570A62000000000000000000000000000000000000000000000000000000005F570A6500000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000000966726F6D5F7363616E00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000004506A000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000F6B76613B7CDCB23B7D47A8469B67AD39705661DD0AC02B44D8D3EE4B61CAF5DD500000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000F6E8AD3BE1B30AD98B3144A47804DF6C98A7B2ACE6F7E3332C33A689882A9AEEAD00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000F6E8AD34B2F5626C1BF40A98F0F71990914A14AB1DA57D9C507D46DF05E3AB395800000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000C00000000000000000000000000000000000000000000000000000000000000F661E55C6C45B1A9E9B86C32BB19BF819A7CB684AABD7FA4BC8C87792DAE52D38F00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000001400000000000000000000000000000000000000000000000000000000000000F65D52D5033592D37ECCA65B227BF3AF502967E0833BB867DBBE6AA0848285BFEB00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000002A000000000000000000000000000000000000000000000000000000000000010322F534578DC2163439705FD7D111DBF6D485B836976F0FD72C6971EB41EB4E5100000000000000000000000000000000000000000000000000000000000006A0000000000000000000000000000000000000000000000000000000000000010400000000000000000000000000000000000000000000000000000000000000A000000000000000000000000000000000000000000000000000000000000001A000000000000000000000000000000000000000000000000000000000000000F600000000000000000000000000000000000000000000000000000000000002C000000000000000000000000000000000000000000000000000000000000000A0000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000C0000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000E00000002464200000000000003E800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000005F570B11000000000000000000000000000000000000000000000000000000005F570B140000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000F6D6840C5D455176BFD3FA8BAC27E7888EF32B70A738D948B4380403EDB369D77300000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000F6E8AD3BE1B30AD98B3144A47804DF6C98A7B2ACE6F7E3332C33A689882A9AEEAD00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000F6E8AD34B2F5626C1BF40A98F0F71990914A14AB1DA57D9C507D46DF05E3AB395800000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000C00000000000000000000000000000000000000000000000000000000000000F661E55C6C45B1A9E9B86C32BB19BF819A7CB684AABD7FA4BC8C87792DAE52D38F00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000001400000000000000000000000000000000000000000000000000000000000000F65D52D5033592D37ECCA65B227BF3AF502967E0833BB867DBBE6AA0848285BFEB00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000002A000000000000000000000000000000000000000000000000000000000000010322F534578DC2163439705FD7D111DBF6D485B836976F0FD72C6971EB41EB4E51",
          { from: bob },
        ),
        "FAIL_REQUEST_IS_NOT_SUCCESSFULLY_RESOLVED",
      );
    });
  });
});
